<!-- Research Cards Template -->
<!-- This template automatically generates research direction cards from the research-directions folder -->
<!-- Data is generated by running: ruby scripts/generate_research_data.rb -->

<div class="research-directions-grid">
    {% if site.data.research_directions and site.data.research_directions.size > 0 %}
        {% for direction_item in site.data.research_directions %}
            {% assign direction_key = direction_item[0] %}
            {% assign direction_data = direction_item[1] %}
        
        <div class="research-direction-card">
            <!-- Research Image -->
            <div class="research-image">
                <img src="{{ site.baseurl }}/research-directions/{{ direction_key }}/images/research-image.jpg" 
                     alt="{{ direction_data.title }}"
                     onerror="this.src='{{ site.baseurl }}/research-directions/{{ direction_key }}/images/research-image.png'; this.onerror=function(){ this.style.display='none'; this.nextElementSibling.style.display='flex'; };">
                <div class="image-placeholder" style="display: none;">
                    <div>
                        <strong>Research Image</strong><br>
                        <small>Add image: /research-directions/{{ direction_key }}/images/research-image.jpg or research-image.png</small>
                    </div>
                </div>
            </div>

            <!-- Research Content -->
            <div class="research-content">
                <h3>{{ direction_data.title }}</h3>
                <div class="research-description">
                    {{ direction_data.content | markdownify }}
                </div>

                <!-- Keywords -->
                {% if direction_data.keywords and direction_data.keywords.size > 0 %}
                <div class="research-keywords">
                    {% for keyword in direction_data.keywords %}
                        <span class="keyword-tag">{{ keyword }}</span>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Papers -->
                {% if direction_data.papers and direction_data.papers.size > 0 %}
                <div class="research-papers">
                    <h4>Related Publications:</h4>
                    <ul class="papers-list">
                        {% for paper in direction_data.papers limit:3 %}
                        <li class="paper-item">
                            {% if paper.url %}
                                <a href="{{ paper.url }}" target="_blank" class="paper-link">
                                    <strong>{{ paper.title }}</strong>
                                </a>
                            {% else %}
                                <strong>{{ paper.title }}</strong>
                            {% endif %}
                            <br>
                            <span class="paper-authors">{{ paper.authors }}</span>
                            {% if paper.journal %}
                                <br><em>{{ paper.journal }}</em>
                            {% endif %}
                            {% if paper.year %}
                                <span class="paper-year">({{ paper.year }})</span>
                            {% endif %}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}

                <!-- Team Members -->
                <div class="research-team">
                    <h4>Team Members:</h4>
                    <div class="team-members" data-members='{{ direction_data.members | jsonify }}' data-members-data='{{ site.data.members | jsonify }}'>
                        <div class="team-placeholder">
                            <div>
                                <strong>Loading Team Members...</strong><br>
                                <small>If this message persists, check member data</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <!-- If no research directions found, show placeholder -->
        <div class="research-directions-placeholder">
            <h3>Research Directions Not Found</h3>
            <p>Research directions will appear here automatically when you add them to the <code>research-directions/</code> folder.</p>
            <p>Run <code>ruby scripts/generate_research_data.rb</code> to update the data after adding/removing research directions.</p>
            <p>See <code>research-directions/README.md</code> for instructions.</p>
        </div>
    {% endif %}
</div>

<!-- Load member containers JavaScript -->
<script src="{{ site.baseurl }}/js/member-containers.js"></script> 